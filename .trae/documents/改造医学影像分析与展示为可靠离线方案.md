## 改造目标
- 使 NIfTI 上传与示例在无 CDN、无打包的环境下稳定可用
- 2D DICOM 阅片保持功能完整，并使用本地 worker 资源
- 界面有明确的进度、错误与统计信息提示

## 技术方案
- 用 Niivue 替代 VTK 做 NIfTI 三维体渲染（Niivue 专为 NIfTI/WebGL，E SM 直接可用）
- 继续使用 `nifti-reader-js` 解析 `.nii/.nii.gz`，将原始体素数据传给 Niivue
- 角石 DICOM：`cornerstone-wado-image-loader` 的 web worker 与 codecs 指向本地 `node_modules` 路径

## 具体改动
1. 依赖与本地加载
- 安装 `niivue`
- 新增 `ensureNiivueLib()`：`import('/node_modules/niivue/dist/niivue.js')` 动态导入并缓存
- 保留 `nifti-reader-js` 动态导入；移除对 VTK 的强依赖

2. NIfTI 渲染改造
- 在 `#vtk-view` 内创建 `<canvas>` 并初始化 `new Niivue({...})`
- 解析 NIfTI 后，将 `dims/pixDims/datatype` 映射到 `nv.addVolumeFromRaw`
- 阈值联动：使用 Niivue 的裁剪/阈值或绘制等值面的替代可视化（优先体渲染，等值面作为可选叠加）
- 成功后更新统计：维度、体素大小、强度范围

3. DICOM 本地化初始化
- `cornerstoneWADOImageLoader.webWorkerManager.initialize`：`webWorkerPath` 指向 `node_modules/cornerstone-wado-image-loader/dist/dynamic-import/index.worker.bundle.min.worker.js`
- `codecsPath` 指向 `node_modules/cornerstone-wado-image-loader/dist/dynamic-import/*.wasm`

4. UI/交互优化
- 统一 `setHint()` 与 `imaging-stats` 的状态更新
- 加载中显示进度（按钮禁用+提示），失败显示可读错误
- 保留“离线二维示例”作为兜底

5. 验证与演示
- 在 `/samples` 放置小体积 `brain.nii.gz`，新增“离线MRI真实示例”按钮从本地加载
- 通过本地服务 `http://localhost:3000/yiliao.html` 验证：上传 NIfTI → 三维体渲染；上传 DICOM → 2D 序列滚动

## 交付结果
- 页面在纯本地环境稳定显示三维 NIfTI，不依赖 CDN/打包
- DICOM 本地 worker/codec 可用，滚动与叠加正常
- 明确的提示与统计信息，用户易于判断状态

请确认是否按此方案实施；确认后我将直接完成代码改造与验证。